units		real
atom_style	full
boundary	p p p 

    
pair_style	lj/cut/coul/long 10.0 10.0 
kspace_style 	pppm 0.0001
bond_style   	harmonic
angle_style  	harmonic

read_data	inputFiles/waters_dens${density}.lmpsys

bond_coeff   	1 5000.0 1.0 
angle_coeff  	1 500.0 109.47
pair_coeff   	* * 0.0 0.0	        # HT
pair_coeff   	2 2 0.15539421659476232 3.16555789  	# OT

timestep	1.0
neighbor	1.0 bin
neigh_modify    every 1 delay 0 check yes

velocity        all create ${temperature} 7654321


minimize 	1.0e-4 1.0e-4 1000 1000



fix 		fxshk all shake 0.0001 20 0 b 1 a 1
#fix 		fxnvt all nvt temp ${temperature} ${temperature} 100.0
fix             fxnpt all npt temp ${temperature} ${temperature} 100.0 iso 1.0 1.0 100.0 


variable        Nevery equal 20                      #Specify the distance (in timesteps) between samples for computing ensemble aver$
                                                     #  (Interval between samples in a block)
variable        Nrepeat equal 50                     #Specify the number of samples per output  of thermodynamic averages
                                                     #  (Samples per block output)
variable        Nfreq equal ${Nevery}*${Nrepeat}     #Specify the dump interval (in timesteps)
                                                     #  (Some people call these blocks)
variable        PotentialEnergy equal epair         #Call the intermolecular potential energy $PotentialEnergy
variable        Pressure equal press                #Call the pressure $Pressure
variable        Temperature equal temp              #Call the instantaneous temperature $Temperature
variable        Density equal density               #Call the instantaneous density $Density (will not change for NVT)


fix             3 all ave/time ${Nevery} ${Nrepeat} ${Nfreq} v_Temperature v_PotentialEnergy v_Pressure file ave.dens_${density}_${temperature}.out format %.8g


thermo_style    custom step temp press vol density epair
thermo          1000
log             outputFiles/thermo_dens_${density}_${temperature}.log



#run 		10000
dump            dmpall	all dcd	1000 outputFiles/water_dens_${density}_${temperature}.dcd   
run 		100000







